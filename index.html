<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CinePower</title>
<style>
  :root {
    --primary: #8a2be2;
    --bg: #0b0014;
    --card: #1c0129;
    --text: #fff;
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }

  header {
    background: var(--card);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px 20px;
    position: sticky;
    top: 0;
    z-index: 10;
  }

  .logo {
    font-size: 22px;
    font-weight: bold;
    color: var(--primary);
  }

  .controls {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .btn {
    background: var(--primary);
    border: none;
    color: white;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.3s;
  }

  .btn:hover {
    background: #9b40f0;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 15px;
    padding: 20px;
  }

  .card {
    background: var(--card);
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s;
  }

  .card:hover {
    transform: scale(1.05);
  }

  .card img {
    width: 100%;
    display: block;
  }

  .card h3 {
    font-size: 14px;
    padding: 10px;
    text-align: center;
  }

  #loginScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    gap: 10px;
  }

  input {
    padding: 8px;
    border-radius: 6px;
    border: none;
    width: 220px;
    outline: none;
  }

  #playerModal {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.9);
    display: none;
    align-items: center;
    justify-content: center;
  }

  #playerModal iframe {
    width: 80%;
    height: 70%;
    border: none;
    border-radius: 10px;
  }

  #closePlayer {
    position: absolute;
    top: 20px;
    right: 40px;
    background: var(--primary);
    color: white;
    border: none;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
  }

</style>
</head>
<body>

<div id="loginScreen">
  <h2>Entrar no CinePower</h2>
  <input type="text" id="user" placeholder="Usuário">
  <input type="password" id="pass" placeholder="Senha">
  <button class="btn" onclick="login()">Entrar</button>
</div>

<div id="mainContent" style="display:none;">
  <header>
    <div class="logo">CinePower</div>
    <div class="controls">
      <button class="btn" id="subscribeBtn">Assinar Premium</button>
      <button class="btn" onclick="logout()">Sair</button>
    </div>
  </header>

  <div class="grid" id="movieGrid"></div>
</div>

<!-- PLAYER -->
<div id="playerModal">
  <button id="closePlayer">Fechar</button>
  <iframe id="moviePlayer" allowfullscreen></iframe>
</div>

<script>
  const adminUser = "kaicki";
  const adminPass = "123456";

  const filmes = [
    { titulo: "Homem-Aranha", id: "1abcxyz" },
    { titulo: "Vingadores", id: "2abcxyz" },
    { titulo: "Batman", id: "3abcxyz" },
  ];

  function login() {
    const u = document.getElementById("user").value;
    const p = document.getElementById("pass").value;

    if (u === adminUser && p === adminPass) {
      localStorage.setItem("cineUser", u);
      document.getElementById("loginScreen").style.display = "none";
      document.getElementById("mainContent").style.display = "block";
      renderFilmes();
    } else {
      alert("Usuário ou senha incorretos!");
    }
  }

  function logout() {
    localStorage.removeItem("cineUser");
    document.getElementById("mainContent").style.display = "none";
    document.getElementById("loginScreen").style.display = "flex";
  }

  function renderFilmes() {
    const grid = document.getElementById("movieGrid");
    grid.innerHTML = "";
    filmes.forEach(f => {
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `<img src="https://via.placeholder.com/300x400?text=${f.titulo}">
                        <h3>${f.titulo}</h3>`;
      card.addEventListener("click", () => abrirPlayer(f.id));
      grid.appendChild(card);
    });
  }

  function abrirPlayer(id) {
    const modal = document.getElementById("playerModal");
    const iframe = document.getElementById("moviePlayer");
    iframe.src = `https://drive.google.com/file/d/${id}/preview`;
    modal.style.display = "flex";
  }

  document.getElementById("closePlayer").addEventListener("click", () => {
    document.getElementById("playerModal").style.display = "none";
    document.getElementById("moviePlayer").src = "";
  });

  // Assinatura Mercado Pago
  const subscribeBtn = document.getElementById("subscribeBtn");
  subscribeBtn.addEventListener("click", async () => {
    subscribeBtn.disabled = true;
    subscribeBtn.textContent = "Gerando pagamento...";
    try {
      const res = await fetch("/api/assinatura");
      const data = await res.json();
      if (data.init_point) {
        window.location.href = data.init_point;
      } else {
        alert("Erro ao criar pagamento!");
      }
    } catch {
      alert("Erro na conexão!");
    }
    subscribeBtn.disabled = false;
    subscribeBtn.textContent = "Assinar Premium";
  });
</script>

</body>
</html>
